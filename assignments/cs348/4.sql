--   Question: 4
--   The strategy behind the formulation of my answer: Starting with the
-- enrollment table, I join another copy of the enrollment table in a group.
-- Additionally, we filter the table such that our mark is greater than 98.
--   Reasonable assumptions (if any): We assume the class averages are less than
-- 98.

SELECT enrollment.sno,
       enrollment.cno,
       enrollment.mark - ROUND(AVG(others.mark), 2) AS difference
FROM enrollment
INNER JOIN enrollment others ON others.cno = enrollment.cno
    AND others.term = enrollment.term
    AND others.section = enrollment.section
WHERE enrollment.mark > 98
GROUP BY enrollment.sno, enrollment.cno, enrollment.term, enrollment.section
ORDER BY enrollment.sno, enrollment.cno;

-- SNO         CNO         difference
-- ----------  ----------  ----------
-- 20002939    CS482       19.62
-- 20037890    PHYS255     17.36
-- 20099883    CS488       14.0
-- 20163094    CS247       14.56
-- 20163094    PHYS497     17.33
-- 20193175    CS449       16.0
-- 20248082    CS350       17.38
-- 20304343    MATH285     15.87
-- 20458699    MATH210     14.37
-- 20458853    PHYS451     12.17
-- 20591079    PHYS420     13.17
-- 20591079    PHYS451     19.58
-- 20602987    CS312       15.12
-- 20602987    CS458       17.96
-- 20652458    PHYS364     12.78
-- 20842491    PHYS484     14.14
-- 20862191    MATH334     17.67
-- 20936107    PHYS484     17.46
-- 20938960    PHYS285     19.69
-- 20954626    MATH395     12.83
-- 21090840    PHYS193     14.62
-- 21152057    PHYS289     14.5
-- 21210918    CS485       19.0
-- 21229888    PHYS124     20.28
-- 21267773    PHYS124     20.28
-- 21288103    PHYS451     12.17
-- 21407646    PHYS263     17.2
-- 21433509    PHYS446     13.0
-- 21495049    PHYS458     15.45
-- 21568625    MATH399     12.2
-- 21646983    PHYS361     20.62
-- 21649510    MATH459     13.1
-- 21649510    PHYS221     12.33
-- 21670504    PHYS485     10.5
-- 21676293    CS488       16.62
-- 21676293    MATH399     12.1
-- 21750774    PHYS483     15.82
-- 21767530    MATH261     18.0
-- 21768045    MATH250     16.57
-- 21818793    CS485       17.18
-- 21821244    MATH491     14.44
-- 21906995    CS432       16.0
-- 21947461    CS316       18.11
-- 21955374    CS484       12.9
-- 21960289    PHYS414     14.36
-- 21993697    MATH226     17.11
-- 22046341    MATH452     12.6
-- 22052239    PHYS255     18.11
-- 22078262    MATH355     16.92
-- 22215932    MATH217     17.47
-- 22233056    MATH261     17.63
-- 22289300    PHYS388     13.0
-- 22296412    CS486       16.6
-- 22318590    PHYS133     18.6
-- 22468169    MATH479     14.0
-- 22492414    CS314       17.38
-- 22556132    CS489       14.5
-- 22564251    CS476       14.58
-- 22788590    CS312       14.96
-- 22788590    CS487       17.59
-- 23008065    PHYS485     14.33
-- 23010891    MATH382     20.76
-- 23049532    CS312       15.96
-- 23067117    MATH192     17.8
-- 23067117    MATH427     19.57
-- 23193544    CS316       15.83
-- 23214247    CS316       13.81
-- 23240776    PHYS312     16.71
-- 23267930    PHYS271     16.5
-- 23314441    MATH340     17.5
-- 23357206    MATH459     13.3
-- 23381814    CS213       18.3
-- 23442335    CS436       17.52
-- 23486913    CS370       17.65
-- 23543938    PHYS460     13.86
-- 23591313    PHYS484     14.62
-- 23610816    CS211       18.36
-- 23749666    CS218       18.45
-- 23759303    PHYS147     12.91
-- 23805142    CS247       14.33
-- 24002271    CS486       17.71
-- 24077663    PHYS368     16.6
-- 24125617    MATH334     16.14
-- 24163544    MATH245     14.5
-- 24169469    MATH358     16.78
-- 24176094    PHYS452     12.5
-- 24236259    PHYS477     17.18
-- 24287823    MATH427     15.8
-- 24294227    CS348       17.82
-- 24410026    CS215       17.87
-- 24596751    MATH217     17.64
-- 24613564    CS338       18.57
-- 24637521    CS314       15.55
-- 24676943    PHYS254     19.04
-- 24860703    PHYS147     16.73
-- 24885811    PHYS194     17.71
-- 24886621    CS446       12.3
-- 24888192    CS350       16.38
-- 24989644    PHYS193     15.2
-- 25129806    CS137       17.0
-- 25132581    CS476       17.14
-- 25286278    MATH192     18.79
-- 25330788    MATH382     15.25
-- 25365706    CS313       15.67
-- 25664679    MATH424     17.0
-- 25672769    CS436       15.2
-- 25743829    MATH459     14.1
-- 25799060    MATH362     17.89
-- 25800239    CS135       17.6
-- 25827649    PHYS420     11.4
-- 25830348    PHYS254     14.27
-- 25835768    MATH217     18.0
-- 25984438    MATH441     19.6
-- 25987170    PHYS398     18.96
-- 26044854    CS450       15.5
-- 26207553    PHYS478     16.09
-- 26247302    PHYS244     13.8
-- 26256419    MATH383     15.29
-- 26342477    PHYS388     17.75
-- 26523244    CS487       17.14
-- 26570974    CS462       18.71
-- 26607054    MATH358     14.8
-- 26627237    MATH221     15.33
-- 26653529    CS115       18.62
-- 26698118    PHYS271     19.0
-- 26836481    MATH381     16.87
-- 27007594    PHYS271     15.64
-- 27007594    PHYS317     17.89
-- 27007594    PHYS458     19.56
-- 27168359    PHYS420     17.64
-- 27279702    CS490       15.0
-- 27279702    PHYS290     16.8
-- 27279702    PHYS485     15.91
-- 27292661    MATH285     16.44
-- 27357294    PHYS271     16.14
-- 27386745    MATH192     16.6
-- 27421447    MATH197     17.1
-- 27464811    CS247       14.12
-- 27493259    PHYS457     12.36
-- 27532359    CS230       14.9
-- 27657997    MATH375     14.56
-- 27717039    MATH381     17.5
-- 27722125    CS246       16.22
-- 27729518    CS147       18.22
-- 27729902    MATH382     15.57
-- 27792707    PHYS255     18.11
-- 27902980    PHYS484     18.46
-- 28013643    CS146       15.0
-- 28025345    MATH428     17.17
-- 28192879    PHYS337     17.12
-- 28231389    MATH459     12.3
-- 28234450    MATH261     16.0
-- 28284876    MATH399     17.83
-- 28471310    PHYS257     19.29
-- 28473457    MATH399     18.83
-- 28513198    MATH226     15.8
-- 28539436    CS240       18.29
-- 28580040    CS458       21.1
-- 28638811    PHYS474     18.5
-- 28921899    PHYS414     13.8
-- 29017604    PHYS455     16.7
-- 29050897    MATH395     17.57
-- 29067979    MATH399     13.1
-- 29119934    CS240       10.75
-- 29171697    MATH197     15.0
-- 29466896    CS312       17.75
-- 29501010    PHYS368     18.0
-- 29507951    MATH452     15.0
-- 29615296    PHYS317     20.0
-- 29643474    CS211       11.5
-- 29808557    PHYS254     18.04
-- 29877646    CS230       13.0
